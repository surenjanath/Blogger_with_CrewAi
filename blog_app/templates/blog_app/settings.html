<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - Blog Post Builder</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'blog_app/css/style.css' %}">
    <link rel="stylesheet" href="{% static 'blog_app/css/settings.css' %}">
</head>
<body>
    <!-- Left Navigation Bar -->
    <nav class="left-nav">
        <a href="/" class="nav-icon" title="Home">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
        </a>
        <a href="/new/" class="nav-icon plus-icon" title="New Post">+</a>
        <a href="/history/" class="nav-icon" title="History">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
        </a>
        <button type="button" class="nav-icon" title="Templates">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
            </svg>
        </button>
        <a href="/settings/" class="nav-icon active" title="Settings">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M12 1v6m0 6v6m9-9h-6m-6 0H3m15.364 6.364l-4.243-4.243m-4.242 0L5.636 18.364m12.728 0l-4.243-4.243m-4.242 0L5.636 5.636"></path>
            </svg>
        </a>
        <div class="nav-dots">
            <div class="dot yellow" title="Status"></div>
            <div class="dot purple" title="Status"></div>
            <div class="dot green" title="Status"></div>
        </div>
        <button type="button" class="nav-icon" title="Search">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.35-4.35"></path>
            </svg>
        </button>
    </nav>

    <div class="main-container">
        <div class="settings-container">
            <!-- Breadcrumb -->
            <nav class="breadcrumb">
                <a href="/">Home</a>
                <span>/</span>
                <span>Settings</span>
            </nav>

            <!-- Header -->
            <div class="settings-header">
                <h1>Settings</h1>
            </div>

            <!-- Tabs -->
            <div class="settings-tabs">
                <button class="settings-tab-btn active" data-tab="ollama">Ollama</button>
                <button class="settings-tab-btn" data-tab="agents">Agents</button>
                <button class="settings-tab-btn" data-tab="tasks">Tasks</button>
                <button class="settings-tab-btn" data-tab="crews">Crews</button>
            </div>

            <!-- Ollama Settings Tab -->
            <div class="settings-tab-content active" id="ollamaTab">
                <div class="settings-section-header">
                    <div>
                        <h2>Ollama Configuration</h2>
                        <p class="section-description">Configure Ollama LLM settings for offline AI processing. When you add a configuration, it will be available for use in blog post generation.</p>
                    </div>
                    <button class="btn-primary" id="addOllamaBtn">+ Add Configuration</button>
                </div>
                
                <!-- Test Connection Section -->
                <div class="test-section">
                    <h3>Test Connection</h3>
                    <div class="test-controls">
                        <button class="btn-secondary" id="testConnectionBtn">Test Connection</button>
                        <button class="btn-secondary" id="fetchModelsBtn">Fetch Available Models</button>
                        <button class="btn-secondary" id="testModelBtn">Test Active Model</button>
                    </div>
                    <div id="testResults" class="test-results"></div>
                </div>
                
                <div id="ollamaSettingsList" class="settings-list"></div>
            </div>

            <!-- Agents Tab -->
            <div class="settings-tab-content" id="agentsTab">
                <div class="settings-section-header">
                    <div>
                        <h2>AI Agents</h2>
                        <p class="section-description">Create and manage AI agents with custom roles, goals, and backstories. Agents work together in crews to generate blog posts.</p>
                    </div>
                    <button class="btn-primary" id="addAgentBtn">+ Add Agent</button>
                </div>
                
                <div id="agentsList" class="settings-list"></div>
            </div>

            <!-- Tasks Tab -->
            <div class="settings-tab-content" id="tasksTab">
                <div class="settings-section-header">
                    <div>
                        <h2>Tasks</h2>
                        <p class="section-description">Define tasks for agents with dependencies and execution order. Tasks are assigned to agents and executed sequentially or in parallel.</p>
                    </div>
                    <button class="btn-primary" id="addTaskBtn">+ Add Task</button>
                </div>
                
                <div id="tasksList" class="settings-list"></div>
            </div>

            <!-- Crews Tab -->
            <div class="settings-tab-content" id="crewsTab">
                <div class="settings-section-header">
                    <div>
                        <h2>Crew Configurations</h2>
                        <p class="section-description">Build and configure AI crews by selecting agents and process type. Crews orchestrate multiple agents to complete complex blog post generation tasks.</p>
                    </div>
                    <button class="btn-primary" id="addCrewBtn">+ Add Crew</button>
                </div>
                
                <div id="crewsList" class="settings-list"></div>
            </div>
        </div>
    </div>

    <!-- Ollama Settings Form Modal -->
    <div id="ollamaFormModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="ollamaFormTitle">Add Ollama Configuration</h3>
                <button class="modal-close" id="closeOllamaFormModal">×</button>
            </div>
            <div class="modal-body">
                <form id="ollamaForm">
                    <input type="hidden" id="ollamaId">
                    <div class="form-group">
                        <label>Configuration Name</label>
                        <input type="text" id="ollamaName" placeholder="e.g., Local Ollama" required>
                    </div>
                    <div class="form-group">
                        <label>Base URL</label>
                        <input type="url" id="ollamaBaseUrl" placeholder="http://localhost:11434" required>
                        <small class="form-help">Ollama server URL (default: http://localhost:11434)</small>
                    </div>
                    <div class="form-group">
                        <label>Model Name</label>
                        <input type="text" id="ollamaModel" placeholder="llama3" required>
                        <small class="form-help">Ollama model to use (e.g., llama3, mistral, codellama)</small>
                    </div>
                    <div class="form-group">
                        <label>Temperature</label>
                        <input type="number" id="ollamaTemperature" value="0.7" min="0" max="2" step="0.1" required>
                        <small class="form-help">Controls randomness (0.0 = deterministic, 2.0 = very creative)</small>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="ollamaIsActive"> Set as Active
                        </label>
                        <small class="form-help">Only one configuration can be active at a time</small>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" id="cancelOllamaForm">Cancel</button>
                        <button type="submit" class="btn-primary">Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Agent Form Modal -->
    <div id="agentFormModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="agentFormTitle">Add Agent</h3>
                <button class="modal-close" id="closeAgentFormModal">×</button>
            </div>
            <div class="modal-body">
                <form id="agentForm">
                    <input type="hidden" id="agentId">
                    <div class="form-group">
                        <label>Name</label>
                        <input type="text" id="agentName" required>
                    </div>
                    <div class="form-group">
                        <label>Role</label>
                        <input type="text" id="agentRole" placeholder="e.g., Research Specialist" required>
                    </div>
                    <div class="form-group">
                        <label>Goal</label>
                        <textarea id="agentGoal" rows="3" placeholder="What should this agent accomplish?" required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Backstory</label>
                        <textarea id="agentBackstory" rows="4" placeholder="Agent's background and expertise..." required></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group half-width">
                            <label>Order</label>
                            <input type="number" id="agentOrder" value="0" min="0">
                        </div>
                        <div class="form-group half-width">
                            <label>
                                <input type="checkbox" id="agentIsActive" checked> Active
                            </label>
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" id="cancelAgentForm">Cancel</button>
                        <button type="submit" class="btn-primary">Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Task Form Modal -->
    <div id="taskFormModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="taskFormTitle">Add Task</h3>
                <button class="modal-close" id="closeTaskFormModal">×</button>
            </div>
            <div class="modal-body">
                <form id="taskForm">
                    <input type="hidden" id="taskId">
                    <div class="form-group">
                        <label>Name</label>
                        <input type="text" id="taskName" required>
                    </div>
                    <div class="form-group">
                        <label>Agent</label>
                        <select id="taskAgent" required></select>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="taskDescription" rows="4" required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Expected Output</label>
                        <textarea id="taskExpectedOutput" rows="2" required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Depends On (Optional)</label>
                        <select id="taskDependsOn">
                            <option value="">None</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="form-group half-width">
                            <label>Order</label>
                            <input type="number" id="taskOrder" value="0" min="0">
                        </div>
                        <div class="form-group half-width">
                            <label>
                                <input type="checkbox" id="taskIsActive" checked> Active
                            </label>
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" id="cancelTaskForm">Cancel</button>
                        <button type="submit" class="btn-primary">Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Crew Form Modal -->
    <div id="crewFormModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="crewFormTitle">Add Crew Configuration</h3>
                <button class="modal-close" id="closeCrewFormModal">×</button>
            </div>
            <div class="modal-body">
                <form id="crewForm">
                    <input type="hidden" id="crewId">
                    <div class="form-group">
                        <label>Name</label>
                        <input type="text" id="crewName" required>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="crewDescription" rows="2"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Process Type</label>
                        <select id="crewProcessType" required>
                            <option value="sequential">Sequential</option>
                            <option value="parallel">Parallel</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Agents</label>
                        <div id="crewAgentsList" class="checkbox-list"></div>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="crewIsDefault"> Set as Default
                        </label>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" id="cancelCrewForm">Cancel</button>
                        <button type="submit" class="btn-primary">Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="{% static 'blog_app/js/settings.js' %}"></script>
</body>
</html>
